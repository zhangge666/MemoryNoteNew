# Memory Note — 主体构造开发说明（更新版）

## 1. 项目概览

**Memory Note** 是一款本地优先的个人知识库与学习系统，支持多标签页、多工作区、插件扩展、I18n 国际化、文件树管理、状态栏增强，以及基于 **艾宾浩斯遗忘曲线** 的复习调度功能。整体目标是结合 VSCode 与 Obsidian 的优势，实现笔记管理、复习提醒、知识学习一体化。
开发是默认语言是中文，并且代码注释不要使用英文，使用中文注释代码

---

## 2. 软件布局

### 标题栏

- 左侧：软件图标、伸缩左侧栏按钮（带平滑动画）、搜索按钮。
    
- 中间：标签管理系统（支持左右分屏、上下分屏）。
    
- 右侧：用户头像（悬停显示个人卡片、学习提醒入口）、右侧栏开关按钮、最小化、最大化、关闭。
    

### 工作区

- 左侧导航栏：**首页、订阅、搜索、日记、复习**（基于艾宾浩斯）、设置按钮。
    
- 左侧栏：工作目录树（支持展开/收起文件夹、右键增强、文件类型识别）。
    
- 内容区域：支持多标签页，分区管理，标签右键增强功能（关闭、移动分区等）。
    
- 右侧栏：用户扩展区，可由插件挂载。
    
注意，每个区域都可以通过拖拽条来调整大小
### 状态栏

- 左侧：服务器连接状态。
    
- 右侧：笔记信息（字数、行列、光标位置）、保存状态或概览数据。
    

---

## 3. 核心功能模块

### 3.1 多标签与分区

- 支持左右/上下分区布局。
    
- 自动关闭空标签分区。
    
- 标签右键增强：关闭当前、关闭其他、移动到分区。
    

### 3.2 插件系统

- 插件可修改 UI（新增按钮、面板）。
    
- 插件需实现 `manifest.json` 与 `data.json` 持久化存储。
    
- 插件可注册到侧边栏与右侧栏。
    
- 插件管理统一在设置界面完成。
    

### 3.3 设置与持久化

- 统一保存方法（实时响应设置变更）。
    
- 设置项包括：工作目录、语言切换、配色主题、插件管理。
    
- 数据存储在 `worker/` 目录下。
    

### 3.4 内存模型与未保存内容

- 采用内存模型层缓存未保存修改，避免切换标签导致数据丢失。
    
- 状态栏实时提示保存状态。
    

### 3.5 国际化（I18n）

- 默认支持中文与英文。
    
- 所有 UI 文本通过 `t()` 方法管理，禁止直接使用组件名称。
    

---

## 4. 复习系统（基于艾宾浩斯遗忘曲线）

### 4.1 功能入口

- 在左侧导航栏新增 **复习** 按钮。
    
- 点击后进入复习计划页面，可查看待复习内容与统计。
    

### 4.2 核心算法

- 使用 SM-2（Anki 常用算法）调度：
    
    - 根据复习结果调整 `ease_factor`、`interval_days`、`repetition_count`。
        
    - 动态计算下次复习时间 `next_review_at`。
        
- 若用户标记“遗忘”，复习间隔立即缩短。
    

### 4.3 数据存储

- `review_schedule` 表（或 JSON 文件）保存：
    
    - note_id
        
    - ease_factor
        
    - interval_days
        
    - repetition_count
        
    - next_review_at
        
- 每次复习后更新存储。
    

### 4.4 UI 交互

- 提示“今日需复习的笔记”。
    
- 学习提醒入口也在用户头像悬浮卡片中展示。
    
- 支持“打卡复习”模式与“批量复习”。
    

---

## 5. 技术架构

### 桌面端

- **Electron + Vue 3 + Vite + Pinia + Tailwind CSS**。
    
- 富文本编辑：`monaco-editor`（支持代码高亮、Markdown 编辑）。
    

### 数据存储

- SQLite + JSON 配合：
    
    - 元数据、复习计划：SQLite。
        
    - 插件数据：独立 JSON 文件。
        

### 插件扩展

- 插件运行于渲染进程沙箱。
    
- 通过受限 API 与主进程交互。
    
- 提供 `.memorynote` 插件目录自动扫描机制。
    

### 国际化

- 使用 `vue-i18n` 管理。
    
- 所有文案通过翻译模板文件配置。
    

---

## 6. 开发里程碑

1. **核心 UI 构建**（标题栏、侧边栏、状态栏、工作区）。
    
2. **文件树与标签管理**（支持基本编辑与未保存模型）。
    
3. **插件系统初版**（支持安装、卸载、设置界面）。
    
4. **复习系统第一版**（支持艾宾浩斯调度、复习日历、学习提醒）。
    
5. **国际化与主题切换**。
    
6. **优化与测试**（UI 流程、数据持久化、插件 API 安全性）。
    

---

## 7. 测试要点

- 标签切换不丢失未保存数据。
    
- 插件安装后可注册到侧边栏或右侧栏。
    
- 设置项变更即时生效并正确存储。
    
- 复习计划能正确生成“今日任务”，且算法计算结果正确。
    
- 国际化语言切换即时应用。
    

---

## 8. 安全与部署

- 插件访问受限 API（需权限声明）。
    
- 数据默认存储在本地 `worker/` 目录，可在设置中修改。
    
- 打包推荐 `electron-builder`，支持跨平台（Windows/macOS/Linux）。
    

---

✅ 本文档为 **Memory Note 主体构造开发说明（更新版）**，在原版基础上补充了 **艾宾浩斯复习系统** 的功能描述与开发要求，可直接交给开发团队使用。